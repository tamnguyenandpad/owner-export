(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{6940:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shares/[shareId]/constructions/[constructionId]/reports",function(){return n(8584)}])},8584:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var r=n(8788),o=n(6383),i=n(4776),s=n.n(i),l=n(2322),a=n(2784),h=n(299),d=n(7693),c=n(7417),u=n(738),p=n(3997),f=n(4823),v=n(2305),g=function(e){var t=e.reports,n=e.renderReportContent,r=(0,p.v9)((function(e){return e.commonState.reportIdForKeepPosition}));return(0,a.useEffect)((function(){var e=document.getElementById(r);e&&e.scrollIntoView()}),[r]),(0,l.jsx)("div",{"data-testid":"report-list",children:t.map((function(e,t){return(0,l.jsx)(f.Z,{className:"rounded-[5px] my-6 h-auto w-full p-[20px] bg-white border border-grey-300 shadow",id:e.id,children:n&&n(e)||(0,l.jsx)(v.Z,{report:e})},t)}))})},b=(0,a.memo)(g),m=n(1169),y=n(4082),w=n(9328),x=n(9390),k=n(1187),j=n(9936),C=n(3906),I=function(){var e=(0,d.I)(),t=(0,x.X)(),n=(0,a.useState)(""),i=n[0],p=n[1],f=(0,k.T)();(0,a.useEffect)((function(){!t([C.P.reportList])&&f.length&&p("\u30a2\u30af\u30bb\u30b9\u3059\u308b\u6a29\u9650\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}),[t,f]);var g=(0,j.qA)({variables:{shareID:(null===e||void 0===e?void 0:e.share.id)||"",constructionID:(null===e||void 0===e?void 0:e.id)||"",offset:0,limit:6},skip:!e||!t([C.P.reportList]),notifyOnNetworkStatusChange:!0,onError:function(e){(0,w.d)(e)}}),I=g.loading,N=g.fetchMore,V=g.data,_=(0,o.Z)((0,c.G)(),2),O=_[0],E=_[1],M=E.openModal,R=E.closeModal,P=null===V||void 0===V?void 0:V.listReports.reports,S=null===V||void 0===V?void 0:V.listReports.isLast;return I&&!P?(0,l.jsx)(u.Z,{}):(0,l.jsx)(l.Fragment,{children:P?(0,l.jsx)("div",{className:" h-auto grow px-2 md:px-6 overflow-y-scroll overflow-x-hidden",children:P.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b,{reports:P,renderReportContent:function(e){return(0,l.jsx)(v.Z,{report:e,renderReportPhoto:function(){return(0,l.jsx)(m.Z,{photo:e.photo||[],photoTotal:e.photoTotal,className:"mt-4",onClickPhoto:function(t){return M({images:(null===e||void 0===e?void 0:e.photo)&&[e.photo]||[],selectedPhotoId:t.id})}})}})}}),I&&(0,l.jsx)("div",{className:"my-4",children:(0,l.jsx)(u.Z,{})}),(0,l.jsx)(y.Z,{images:O.images,isShow:O.isShow,closeModal:R}),(0,l.jsx)(h.df,{onChange:function(){var t=(0,r.Z)(s().mark((function t(n){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=P.length||0,!n||S){t.next=4;break}return t.next=4,N({variables:{shareID:null===e||void 0===e?void 0:e.share.id,constructionID:null===e||void 0===e?void 0:e.id,offset:r,limit:6}});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})]}):(0,l.jsx)("div",{className:"text-grey-400 flex justify-center items-center h-full",children:"\u5831\u544a\u304c\u3042\u308a\u307e\u305b\u3093\u3002"})}):(0,l.jsx)("div",{className:" h-auto grow px-6 overflow-y-scroll overflow-x-hidden",children:(0,l.jsx)("div",{className:"text-grey-400 flex justify-center items-center h-full",children:i})})})},N=(0,a.memo)(I)},299:function(e,t,n){"use strict";n.d(t,{df:function(){return p}});var r=n(2784);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}const i=new Map,s=new WeakMap;let l,a=0;function h(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{return`${t}_${"root"===t?(n=e.root,n?(s.has(n)||(a+=1,s.set(n,a.toString())),s.get(n)):"0"):e[t]}`;var n})).toString()}function d(e,t,n={},r=l){if("undefined"===typeof window.IntersectionObserver&&void 0!==r){const o=e.getBoundingClientRect();return t(r,{isIntersecting:r,target:e,intersectionRatio:"number"===typeof n.threshold?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:o,observer:s,elements:a}=function(e){let t=h(e),n=i.get(t);if(!n){const r=new Map;let o;const s=new IntersectionObserver((t=>{t.forEach((t=>{var n;const i=t.isIntersecting&&o.some((e=>t.intersectionRatio>=e));e.trackVisibility&&"undefined"===typeof t.isVisible&&(t.isVisible=i),null==(n=r.get(t.target))||n.forEach((e=>{e(i,t)}))}))}),e);o=s.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:s,elements:r},i.set(t,n)}return n}(n);let d=a.get(e)||[];return a.has(e)||a.set(e,d),d.push(t),s.observe(e),function(){d.splice(d.indexOf(t),1),0===d.length&&(a.delete(e),s.unobserve(e)),0===a.size&&(s.disconnect(),i.delete(o))}}const c=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function u(e){return"function"!==typeof e.children}class p extends r.Component{constructor(e){super(e),this.node=null,this._unobserveCb=null,this.handleNode=e=>{this.node&&(this.unobserve(),e||this.props.triggerOnce||this.props.skip||this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=e||null,this.observeNode()},this.handleChange=(e,t)=>{e&&this.props.triggerOnce&&this.unobserve(),u(this.props)||this.setState({inView:e,entry:t}),this.props.onChange&&this.props.onChange(e,t)},this.state={inView:!!e.initialInView,entry:void 0}}componentDidUpdate(e){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold&&e.skip===this.props.skip&&e.trackVisibility===this.props.trackVisibility&&e.delay===this.props.delay||(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve(),this.node=null}observeNode(){if(!this.node||this.props.skip)return;const{threshold:e,root:t,rootMargin:n,trackVisibility:r,delay:o,fallbackInView:i}=this.props;this._unobserveCb=d(this.node,this.handleChange,{threshold:e,root:t,rootMargin:n,trackVisibility:r,delay:o},i)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){if(!u(this.props)){const{inView:e,entry:t}=this.state;return this.props.children({inView:e,entry:t,ref:this.handleNode})}const e=this.props,{children:t,as:n}=e,i=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,c);return r.createElement(n||"div",o({ref:this.handleNode},i),t)}}}},function(e){e.O(0,[235,918,305,774,888,179],(function(){return t=6940,e(e.s=t);var t}));var t=e.O();_N_E=t}]);